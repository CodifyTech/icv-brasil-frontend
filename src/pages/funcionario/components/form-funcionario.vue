<script setup lang="ts">
import { storeToRefs } from 'pinia'
import { useFuncionarioStore } from '../store/useFuncionarioStore'
import LayoutForms from '@/components/CDF/LayoutForms.vue'
import * as cdfRules from '@/validators/cdf-rules'
import CDFManager from '@/components/CDF/CDFManager.vue'

const { isEditing } = withDefaults(defineProps<{
  isEditing: boolean
  isHeader: boolean
}>(), {
  isEditing: false,
  isHeader: true,
})

const store = useFuncionarioStore()

onMounted(() => {
  // 游녤 methods
})

const {
  form,
  data,
  loading,
} = storeToRefs(store)

const tab = ref('dados_pessoais')

const {
  save,
  update,
  resetForm,
} = store

onBeforeRouteLeave(() => {
  resetForm()
})
</script>

<template>
  <LayoutForms
    v-model:form="form"
    v-model:loading="loading.save"
    :title="!isEditing ? 'Cadastrar Funcion치rio' : 'Editar Funcion치rio'"
    :is-editing="isEditing"
    :is-header="isHeader"
    :actions="{
      save: {
        method: () => save(),
      },
      update: {
        method: () => update(),
      },
      reset: {
        method: () => resetForm(),
      },
    }"
    back="/funcionario"
  >
    <template #content>
      <VCol cols="12">
        <VCard flat>
          <VCardText class="px-0">
            <VRow>
              <VCol cols="12">
                <CDFTextField
                  v-model="data.nome"
                  label="Nome Completo"
                  placeholder="Digite o nome completo"
                  :rules="[cdfRules.requiredValidator]"
                />
              </VCol>
              <VCol
                cols="12"
                md="6"
              >
                <CDFTextField
                  v-model="data.rg"
                  label="RG"
                  placeholder="Digite o n칰mero do RG"
                  :rules="[]"
                />
              </VCol>
              <VCol
                cols="12"
                md="6"
              >
                <CDFTextField
                  v-model="data.cpf"
                  v-mask="'###.###.###-##'"
                  label="CPF"
                  placeholder="Digite o n칰mero do CPF"
                  :rules="[cdfRules.requiredValidator]"
                />
              </VCol>
              <VCol
                cols="12"
                md="6"
              >
                <CDFTextField
                  v-model="data.telefone_1"
                  v-mask="'(##) ####-####'"
                  type="tel"
                  label="Telefone 1"
                  placeholder="Digite o n칰mero do telefone 1"
                  :rules="[]"
                />
              </VCol>
              <VCol
                cols="12"
                md="6"
              >
                <CDFTextField
                  v-model="data.telefone_2"
                  v-mask="'(##) ####-####'"
                  type="tel"
                  label="Telefone 2"
                  placeholder="Digite o n칰mero do telefone 2"
                  :rules="[]"
                />
              </VCol>
              <VCol
                cols="12"
                md="6"
              >
                <CDFTextField
                  v-model="data.email_1"
                  label="E-mail 1"
                  placeholder="Digite o endere칞o de e-mail 1"
                  :rules="[]"
                />
              </VCol>
              <VCol
                cols="12"
                md="6"
              >
                <CDFTextField
                  v-model="data.email_2"
                  label="E-mail 2"
                  placeholder="Digite o endere칞o de e-mail 2"
                  :rules="[]"
                />
              </VCol>
              <VCol cols="12">
                <Endereco v-model:data="data" />
              </VCol>
              <VCol cols="12">
                <AppTextarea
                  v-model="data.aeroporto_proximo"
                  label="Aeroporto Pr칩ximo"
                  placeholder="Digite o nome do aeroporto mais pr칩ximo"
                  :rules="[]"
                />
              </VCol>
              <VCol cols="12">
                <VTabs v-model="tab">
                  <VTab value="qualificacoes_pofissionais">
                    Qualifica칞칫es Profissionais
                  </VTab>
                  <VTab value="atestados_ocupacionais_epi">
                    Atestado Ocupacionais/EPI
                  </VTab>
                  <VTab value="dados_empresariais">
                    Dados Empresariais
                  </VTab>
                  <VTab value="dados_bancarios">
                    Dados Banc치rios
                  </VTab>
                  <VTab value="honrarios">
                    Honor치rios
                  </VTab>
                </VTabs>

                <VTabsWindow v-model="tab">
                  <VTabsWindowItem
                    value="qualificacoes_pofissionais"
                    class="pa-2"
                  >
                    <div class="d-flex flex-column gap-2">
                      <CDFManager
                        v-model:items="data.formacoes"
                        title="Forma칞칚o"
                        item-title="nome"
                        item-label="Forma칞칚o"
                        message-add="Adicionar Forma칞칚o"
                        :template="{
                          nome: '',
                          conselho_classe: '',
                        }"
                      >
                        <template #content="{ item }">
                          <VRow>
                            <VCol
                              cols="12"
                              md="6"
                            >
                              <CDFTextField
                                v-model="item.nome"
                                label="Forma칞칚o"
                                placeholder="Digite a nome da form칞칚o"
                                :rules="[cdfRules.requiredValidator]"
                              />
                            </VCol>
                            <VCol
                              cols="12"
                              md="6"
                            >
                              <CDFTextField
                                v-model="item.conselho_classe"
                                label="Conselho de Classe"
                                placeholder="Digite o conselho de classe"
                                :rules="[cdfRules.requiredValidator]"
                              />
                            </VCol>
                          </VRow>
                        </template>
                      </CDFManager>

                      <VCard title="Qualifica칞칚o">
                        <VCardText>
                          <VRow>
                            <VCol
                              cols="12"
                              md="4"
                            >
                              <CDFTextField
                                v-model="data.nome"
                                label="Nome da Qualifica칞칚o"
                                placeholder="Digite o nome da qualifica칞칚o"
                                :rules="[cdfRules.requiredValidator]"
                              />
                            </VCol>
                            <VCol
                              cols="12"
                              md="4"
                            >
                              <CDFTextField
                                v-model="data.validate"
                                label="Validate"
                                placeholder="Digite o validate"
                                type="date"
                                :rules="[]"
                              />
                            </VCol>
                            <VCol
                              cols="12"
                              md="4"
                            >
                              <CDFTextField
                                v-model="data.utilma_avaliacao"
                                label="Utilma Avalia칞칚o"
                                placeholder="Digite o utilma avalia칞칚o"
                                type="date"
                                :rules="[]"
                              />
                            </VCol>
                            <VCol
                              cols="12"
                              md="4"
                            >
                              <CDFTextField
                                v-model="data.validate_avaliacao"
                                label="Validate Avalia칞칚o"
                                placeholder="Digite o validate avalia칞칚o"
                                type="date"
                                :rules="[]"
                              />
                            </VCol>
                          </VRow>
                        </VCardText>
                      </VCard>
                    </div>
                  </VTabsWindowItem>

                  <VTabsWindowItem
                    value="atestados_ocupacionais_epi"
                    class="pa-2"
                  >
                    <div class="d-flex flex-column gap-2">
                      <VCard title="Atestado ocupacional">
                        <VCardText>
                          <VRow>
                            <VCol
                              cols="12"
                              md="4"
                            >
                              <CDFTextField
                                v-model="data.nome"
                                label="Nome"
                                placeholder="Digite o nome"
                                :rules="[cdfRules.requiredValidator]"
                              />
                            </VCol>
                            <VCol
                              cols="12"
                              md="4"
                            >
                              <CDFTextField
                                v-model="data.validade"
                                label="Validade"
                                placeholder="Digite o validade"
                                :rules="[]"
                              />
                            </VCol>
                            <VCol
                              cols="12"
                              md="4"
                            >
                              <CDFTextField
                                v-model="data.exame"
                                label="Exame"
                                placeholder="Digite o exame"
                                :rules="[]"
                              />
                            </VCol>
                          </VRow>
                        </VCardText>
                      </VCard>

                      <VCard title="EPI">
                        <VCardText>
                          <VRow>
                            <VCol
                              cols="12"
                              md="4"
                            >
                              <CDFTextField
                                v-model="data.nome"
                                label="Nome"
                                placeholder="Digite o nome do EPI"
                                :rules="[cdfRules.requiredValidator]"
                              />
                            </VCol>
                            <VCol
                              cols="12"
                              md="4"
                            >
                              <CDFTextField
                                v-model="data.ca"
                                label="CA"
                                placeholder="Digite o certificado de autoriza칞칚o"
                                :rules="[cdfRules.requiredValidator]"
                              />
                            </VCol>
                          </VRow>
                        </VCardText>
                      </VCard>
                    </div>
                  </VTabsWindowItem>

                  <VTabsWindowItem
                    value="dados_empresariais"
                    class="pa-2"
                  >
                    <VRow>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <CDFTextField
                          v-model="data.razao_social"
                          label="Raz칚o Social"
                          placeholder="Digite a raz칚o social"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <CDFTextField
                          v-model="data.nome_fantasia"
                          label="Nome Fantasia"
                          placeholder="Digite o nome fantasia"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <CDFTextField
                          v-model="data.cnpj"
                          v-mask="'##.###.###/####-##'"
                          label="CNPJ"
                          placeholder="Digite o n칰mero do CNPJ"
                          :rules="[]"
                        />
                      </VCol>
                    </VRow>
                  </VTabsWindowItem>

                  <VTabsWindowItem
                    value="dados_bancarios"
                    class="pa-2"
                  >
                    <VRow>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <CDFTextField
                          v-model="data.banco"
                          label="Banco"
                          placeholder="Digite o n칰mero do banco"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <CDFTextField
                          v-model="data.agencia"
                          label="Ag칡ncia"
                          placeholder="Digite o n칰mero da ag칡ncia"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <CDFTextField
                          v-model="data.conta"
                          label="Conta"
                          placeholder="Digite o n칰mero da conta"
                          :rules="[]"
                        />
                      </VCol>
                    </VRow>
                  </VTabsWindowItem>

                  <VTabsWindowItem
                    value="honrarios"
                    class="pa-2"
                  >
                    <VRow>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <InputDinheiro
                          v-model="data.valor_hh"
                          label="Valor Hora Homem"
                          placeholder="Digite o valor da hora homem"
                          prepend-inner-icon="tabler-currency-real"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <InputDinheiro
                          v-model="data.valor_diaria"
                          label="Digite o Valor Di치ria"
                          placeholder="Digite o valor da di치ria"
                          prepend-inner-icon="tabler-currency-real"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <InputDinheiro
                          v-model="data.valor_demanda"
                          label="Valor Demanda"
                          placeholder="Digite o valor da demanda"
                          prepend-inner-icon="tabler-currency-real"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <InputDinheiro
                          v-model="data.valor_deslocamento"
                          label="Valor Deslocamento"
                          placeholder="Digite o valor do deslocamento"
                          prepend-inner-icon="tabler-currency-real"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <InputDinheiro
                          v-model="data.valor_refeicao"
                          label="Valor Refei칞칚o"
                          placeholder="Digite o valor da refei칞칚o"
                          prepend-inner-icon="tabler-currency-real"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <InputDinheiro
                          v-model="data.valor_pedagio"
                          label="Valor Ped치gio"
                          placeholder="Digite o valor do ped치gio"
                          prepend-inner-icon="tabler-currency-real"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <InputDinheiro
                          v-model="data.valor_hospedagem"
                          label="Valor Hospedagem"
                          placeholder="Digite o valor da hospedagem"
                          prepend-inner-icon="tabler-currency-real"
                          :rules="[]"
                        />
                      </VCol>
                      <VCol
                        cols="12"
                        md="4"
                      >
                        <InputDinheiro
                          v-model="data.valor_outros"
                          label="Valor Outros"
                          placeholder="Digite o valor de outros"
                          prepend-inner-icon="tabler-currency-real"
                          :rules="[]"
                        />
                      </VCol>
                    </VRow>
                  </VTabsWindowItem>
                </VTabsWindow>
              </VCol>
            </VRow>
          </VCardText>
        </VCard>
      </VCol>
    </template>
  </LayoutForms>
</template>
